<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<head>
    <title>rFold reference</title>
    <link rel="stylesheet" href="../ldoc.css" type="text/css" />
</head>
<body>

<div id="container">

<div id="product">
	<div id="product_logo"></div>
	<div id="product_name"><big><b></b></big></div>
	<div id="product_description"></div>
</div> <!-- id="product" -->


<div id="main">


<!-- Menu -->

<div id="navigation">
<br/>
<h1>rFold</h1>

<ul>
  <li><a href="../index.html">Index</a></li>
</ul>

<h2>Contents</h2>
<ul>
<li><a href="#Functions">Functions</a></li>
<li><a href="#Fields">Fields</a></li>
<li><a href="#Methods">Methods</a></li>
</ul>


<h2>Classes</h2>
<ul class="$(kind=='Topics' and '' or 'nowrap'">
  <li><a href="../classes/Protein.html">Protein</a></li>
  <li><strong>Chain</strong></li>
  <li><a href="../classes/Residue.html">Residue</a></li>
  <li><a href="../classes/Dihedron.html">Dihedron</a></li>
  <li><a href="../classes/Hedron.html">Hedron</a></li>
  <li><a href="../classes/geom3d.html">geom3d</a></li>
  <li><a href="../classes/parsers.html">parsers</a></li>
  <li><a href="../classes/utils.html">utils</a></li>
</ul>
<h2>Topics</h2>
<ul class="$(kind=='Topics' and '' or 'nowrap'">
  <li><a href="../topics/README.md.html">README</a></li>
</ul>
<h2>Examples</h2>
<ul class="$(kind=='Topics' and '' or 'nowrap'">
  <li><a href="../examples/buildProtein.lua.html">buildProtein.lua</a></li>
</ul>

</div>

<div id="content">

<h1>Class <code>Chain</code></h1>
<p>protein chain class for rFold</p>
<p>

</p>


<h2><a href="#Functions">Functions</a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#chain.new">chain.new (o)</a></td>
	<td class="summary">Chain class object initialiser (not a class method)</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#chain.reportDbChain">chain.reportDbChain (rfpg, pdbid, chainid)</a></td>
	<td class="summary">query database for info about specified chain (not a class method)</td>
	</tr>
</table>
<h2><a href="#Fields">Fields</a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#Chain.residues">Chain.residues</a></td>
	<td class="summary">array of residue ordered and disordered objects indexed by sequence position</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Chain.initNCaC">Chain.initNCaC</a></td>
	<td class="summary">array of atomCoordinates (4x1 float matrices) for initial N,Ca,C residues of all ordered segments of this chain indexed by atomKeys (resPos res atom)</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Chain.id">Chain.id</a></td>
	<td class="summary">chain ID from PDB file</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Chain.pdbid">Chain.pdbid</a></td>
	<td class="summary">4-position PDB identifier</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Chain.firstPos">Chain.firstPos</a></td>
	<td class="summary">signed integer indicating sequence position of first residue in chain</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Chain.seqres">Chain.seqres</a></td>
	<td class="summary">PDB file SEQRES data for this chain</td>
	</tr>
</table>
<h2><a href="#Methods">Methods</a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#Chain:getResidue">Chain:getResidue (ires, iresn, disordered)</a></td>
	<td class="summary">find or initialise Residue object (ordered by definition) for specified amino acid and sequence position
 will set firstPos (first residue in this chain) if appropriate (if not set already)
 else any missing residues between firstPos and this one will be set to {} (disordered)</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Chain:load">Chain:load (t)</a></td>
	<td class="summary">find or create Residue for passed data table, pass table to it for loading</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Chain:orderedResidues">Chain:orderedResidues (a)</a></td>
	<td class="summary">initialiser for Chain:oResIter()</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Chain:countOrderedResidues">Chain:countOrderedResidues ()</a></td>
	<td class="summary">count ordered residues in chain according to orderedResidues()</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Chain:allResidues">Chain:allResidues (a)</a></td>
	<td class="summary">initialiser for Chain:aResIter()</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Chain:countAllResidues">Chain:countAllResidues ()</a></td>
	<td class="summary">count all residues in chain according to allResidues()</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Chain:setPrevNext">Chain:setPrevNext (i, r)</a></td>
	<td class="summary">implement assign 'prev' and 'next' for passed Residues[] index and residue</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Chain:linkResidues">Chain:linkResidues ()</a></td>
	<td class="summary">assign 'prev' and 'next' for Residues in self['residues']; trigger Residue to link its dihedra (create map of keys to dihedra, link dihedron atoms into backbone and sidechain tables)</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Chain:countHedra">Chain:countHedra ()</a></td>
	<td class="summary">query each Residue for its count of hedra</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Chain:countDihedra">Chain:countDihedra ()</a></td>
	<td class="summary">query each Residue for its count of dihedra</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Chain:countDSSPs">Chain:countDSSPs ()</a></td>
	<td class="summary">query each Resdiue for a DSSP record</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Chain:clearAtomCoords">Chain:clearAtomCoords ()</a></td>
	<td class="summary">delete protein space atom coordinate data from this chain</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Chain:clearInternalCoords">Chain:clearInternalCoords ()</a></td>
	<td class="summary">delete internal coordinate data from this chain</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Chain:seqStr">Chain:seqStr ()</a></td>
	<td class="summary">concatenate 1-letter amino acid codes for Residues in this chain</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Chain:renderDihedra">Chain:renderDihedra ()</a></td>
	<td class="summary">trigger generation of atom coordinates for updated Hedra in Residues in this Chain, then do same for updated Dihedra.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Chain:dihedraFromAtoms">Chain:dihedraFromAtoms ()</a></td>
	<td class="summary">foreach chain, complete residue, dihedra, hedra data structures from protein space atom coordinates</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Chain:assembleResidues">Chain:assembleResidues ()</a></td>
	<td class="summary">for each Residue in Chain, set startPos and then trigger Residue to assemble atoms from its Dihedrons starting with the startPos coordinates for N, CA, C
<br>
 first Residue startPos is set from DSSP or other source to match PDB file, subsequent startPos's read from previous residue backbone atom coordinates in protein coordinate space</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Chain:writePDB">Chain:writePDB (ndx, range)</a></td>
	<td class="summary">trigger each Residue in Chain to generate PDB ATOM records, add TER record at end of chain</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Chain:writeInternalCoords">Chain:writeInternalCoords (range)</a></td>
	<td class="summary">generate PIC hedra and dihedra records for each residue in chain</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Chain:writeDb">Chain:writeDb (rfpg, pdb_no, update)</a></td>
	<td class="summary">write chain data to rfold database</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Chain:dbLoad">Chain:dbLoad (rfpg)</a></td>
	<td class="summary">populate chain object from database using supplied pdb and chain id</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Chain:reportDb">Chain:reportDb (rfpg)</a></td>
	<td class="summary">query database for info about this chain</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Chain:setStartCoords">Chain:setStartCoords ()</a></td>
	<td class="summary">if first Residue in Chain has 'dssp' field, set self['initNCaC'] to hold those protein space coordinates to build the rest of the Chain from</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#Chain:countResidues">Chain:countResidues ()</a></td>
	<td class="summary">report ordered (with coordinates) residues in this chain</td>
	</tr>
</table>

<br/>
<br/>


    <h2 class="section-header "><a name="Functions"></a>Functions</h2>
    Methods
    <dl class="function">
    <dt>
    <a name = "chain.new"></a>
    <strong>chain.new (o)</strong>
    </dt>
    <dd>
    Chain class object initialiser (not a class method)


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">o</span>
         table with field 'id' = chain ID; ' ' or '' is val
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        minimally initialised Chain object
    </ol>




</dd>
    <dt>
    <a name = "chain.reportDbChain"></a>
    <strong>chain.reportDbChain (rfpg, pdbid, chainid)</strong>
    </dt>
    <dd>
    query database for info about specified chain (not a class method)


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">rfpg</span>
         open database handle
        </li>
        <li><span class="parameter">pdbid</span>
         4 character PDB code
        </li>
        <li><span class="parameter">chainid</span>
         1 character chain identiifier
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        report string for printing
    </ol>




</dd>
</dl>
    <h2 class="section-header "><a name="Fields"></a>Fields</h2>

    <dl class="function">
    <dt>
    <a name = "Chain.residues"></a>
    <strong>Chain.residues</strong>
    </dt>
    <dd>
    array of residue ordered and disordered objects indexed by sequence position


    <ul>
        <li><span class="parameter">residues</span>
         array of residue objects
        </li>
    </ul>





</dd>
    <dt>
    <a name = "Chain.initNCaC"></a>
    <strong>Chain.initNCaC</strong>
    </dt>
    <dd>
    array of atomCoordinates (4x1 float matrices) for initial N,Ca,C residues of all ordered segments of this chain indexed by atomKeys (resPos res atom)


    <ul>
        <li><span class="parameter">initNCaC</span>



        </li>
    </ul>





</dd>
    <dt>
    <a name = "Chain.id"></a>
    <strong>Chain.id</strong>
    </dt>
    <dd>
    chain ID from PDB file


    <ul>
        <li><span class="parameter">id</span>
         char
        </li>
    </ul>





</dd>
    <dt>
    <a name = "Chain.pdbid"></a>
    <strong>Chain.pdbid</strong>
    </dt>
    <dd>
    4-position PDB identifier


    <ul>
        <li><span class="parameter">pdbid</span>
         string
        </li>
    </ul>





</dd>
    <dt>
    <a name = "Chain.firstPos"></a>
    <strong>Chain.firstPos</strong>
    </dt>
    <dd>
    signed integer indicating sequence position of first residue in chain


    <ul>
        <li><span class="parameter">firstPos</span>
         integer
        </li>
    </ul>





</dd>
    <dt>
    <a name = "Chain.seqres"></a>
    <strong>Chain.seqres</strong>
    </dt>
    <dd>
    PDB file SEQRES data for this chain


    <ul>
        <li><span class="parameter">seqres</span>
         string
        </li>
    </ul>





</dd>
</dl>
    <h2 class="section-header "><a name="Methods"></a>Methods</h2>

    <dl class="function">
    <dt>
    <a name = "Chain:getResidue"></a>
    <strong>Chain:getResidue (ires, iresn, disordered)</strong>
    </dt>
    <dd>
    find or initialise Residue object (ordered by definition) for specified amino acid and sequence position
 will set firstPos (first residue in this chain) if appropriate (if not set already)
 else any missing residues between firstPos and this one will be set to {} (disordered)


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">ires</span>
         uppercase 1-letter amino acid code
        </li>
        <li><span class="parameter">iresn</span>
         sequence position of residue in this chain
        </li>
        <li><span class="parameter">disordered</span>
         optional boolean to indicate disordered residue (default is ordered)
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        Residue object, minimally initialised and referenced from self['residues'][iresn]
    </ol>




</dd>
    <dt>
    <a name = "Chain:load"></a>
    <strong>Chain:load (t)</strong>
    </dt>
    <dd>
    find or create Residue for passed data table, pass table to it for loading


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">t</span>
         table created by file parser, passed here as callback
        </li>
    </ul>





</dd>
    <dt>
    <a name = "Chain:orderedResidues"></a>
    <strong>Chain:orderedResidues (a)</strong>
    </dt>
    <dd>
    initialiser for Chain:oResIter()


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">a</span>
         array of residues to iterate in numeric order
        </li>
    </ul>





</dd>
    <dt>
    <a name = "Chain:countOrderedResidues"></a>
    <strong>Chain:countOrderedResidues ()</strong>
    </dt>
    <dd>
    count ordered residues in chain according to orderedResidues()



    <h3>Returns:</h3>
    <ol>

        count of ordered residues
    </ol>




</dd>
    <dt>
    <a name = "Chain:allResidues"></a>
    <strong>Chain:allResidues (a)</strong>
    </dt>
    <dd>
    initialiser for Chain:aResIter()


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">a</span>
         array of residues to iterate in numeric order
        </li>
    </ul>





</dd>
    <dt>
    <a name = "Chain:countAllResidues"></a>
    <strong>Chain:countAllResidues ()</strong>
    </dt>
    <dd>
    count all residues in chain according to allResidues()



    <h3>Returns:</h3>
    <ol>

        count of all residues
    </ol>




</dd>
    <dt>
    <a name = "Chain:setPrevNext"></a>
    <strong>Chain:setPrevNext (i, r)</strong>
    </dt>
    <dd>
    implement assign 'prev' and 'next' for passed Residues[] index and residue


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">i</span>



        </li>
        <li><span class="parameter">r</span>



        </li>
    </ul>





</dd>
    <dt>
    <a name = "Chain:linkResidues"></a>
    <strong>Chain:linkResidues ()</strong>
    </dt>
    <dd>
    assign 'prev' and 'next' for Residues in self['residues']; trigger Residue to link its dihedra (create map of keys to dihedra, link dihedron atoms into backbone and sidechain tables)







</dd>
    <dt>
    <a name = "Chain:countHedra"></a>
    <strong>Chain:countHedra ()</strong>
    </dt>
    <dd>
    query each Residue for its count of hedra



    <h3>Returns:</h3>
    <ol>

        sum of hedra for Residues in chain
    </ol>




</dd>
    <dt>
    <a name = "Chain:countDihedra"></a>
    <strong>Chain:countDihedra ()</strong>
    </dt>
    <dd>
    query each Residue for its count of dihedra



    <h3>Returns:</h3>
    <ol>

        sum of dihedra for Residues in chain
    </ol>




</dd>
    <dt>
    <a name = "Chain:countDSSPs"></a>
    <strong>Chain:countDSSPs ()</strong>
    </dt>
    <dd>
    query each Resdiue for a DSSP record



    <h3>Returns:</h3>
    <ol>

        sum of Residues in chain with DSSP records
    </ol>




</dd>
    <dt>
    <a name = "Chain:clearAtomCoords"></a>
    <strong>Chain:clearAtomCoords ()</strong>
    </dt>
    <dd>
    delete protein space atom coordinate data from this chain







</dd>
    <dt>
    <a name = "Chain:clearInternalCoords"></a>
    <strong>Chain:clearInternalCoords ()</strong>
    </dt>
    <dd>
    delete internal coordinate data from this chain







</dd>
    <dt>
    <a name = "Chain:seqStr"></a>
    <strong>Chain:seqStr ()</strong>
    </dt>
    <dd>
    concatenate 1-letter amino acid codes for Residues in this chain



    <h3>Returns:</h3>
    <ol>

        chain amino acid sequence as string
    </ol>




</dd>
    <dt>
    <a name = "Chain:renderDihedra"></a>
    <strong>Chain:renderDihedra ()</strong>
    </dt>
    <dd>
    trigger generation of atom coordinates for updated Hedra in Residues in this Chain, then do same for updated Dihedra.
 <br>
 Dihedra depend on hedra in adjacent Residues, so must complete hedra first







</dd>
    <dt>
    <a name = "Chain:dihedraFromAtoms"></a>
    <strong>Chain:dihedraFromAtoms ()</strong>
    </dt>
    <dd>
    foreach chain, complete residue, dihedra, hedra data structures from protein space atom coordinates







</dd>
    <dt>
    <a name = "Chain:assembleResidues"></a>
    <strong>Chain:assembleResidues ()</strong>
    </dt>
    <dd>
    for each Residue in Chain, set startPos and then trigger Residue to assemble atoms from its Dihedrons starting with the startPos coordinates for N, CA, C
<br>
 first Residue startPos is set from DSSP or other source to match PDB file, subsequent startPos's read from previous residue backbone atom coordinates in protein coordinate space





    <h3>See also:</h3>
    <ul>
         <a href="../classes/Chain.html#Chain:setStartCoords">setStartCoords</a>
    </ul>


</dd>
    <dt>
    <a name = "Chain:writePDB"></a>
    <strong>Chain:writePDB (ndx, range)</strong>
    </dt>
    <dd>
    trigger each Residue in Chain to generate PDB ATOM records, add TER record at end of chain


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">ndx</span>
         counter for lines in pdb output file
        </li>
        <li><span class="parameter">range</span>
         optional begin:end filter for residues to print
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        string of PDB format records for ATOMS in Chain, plus TER record
    </ol>




</dd>
    <dt>
    <a name = "Chain:writeInternalCoords"></a>
    <strong>Chain:writeInternalCoords (range)</strong>
    </dt>
    <dd>
    generate PIC hedra and dihedra records for each residue in chain


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">range</span>
         optional begin:end filter for residues to print
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        string of PIC format records for residues in Chain
    </ol>




</dd>
    <dt>
    <a name = "Chain:writeDb"></a>
    <strong>Chain:writeDb (rfpg, pdb_no, update)</strong>
    </dt>
    <dd>
    write chain data to rfold database


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">rfpg</span>
         open database handle
        </li>
        <li><span class="parameter">pdb_no</span>
         chain ID in pdb_chain table
        </li>
        <li><span class="parameter">update</span>
         optional flag, if false silently skip if [pdb<em>no, res</em>ndx] entry exists already in residue table
        </li>
    </ul>





</dd>
    <dt>
    <a name = "Chain:dbLoad"></a>
    <strong>Chain:dbLoad (rfpg)</strong>
    </dt>
    <dd>
    populate chain object from database using supplied pdb and chain id


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">rfpg</span>
         open database handle
        </li>
    </ul>





</dd>
    <dt>
    <a name = "Chain:reportDb"></a>
    <strong>Chain:reportDb (rfpg)</strong>
    </dt>
    <dd>
    query database for info about this chain


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">rfpg</span>
         open database handle
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        report string for printing
    </ol>




</dd>
    <dt>
    <a name = "Chain:setStartCoords"></a>
    <strong>Chain:setStartCoords ()</strong>
    </dt>
    <dd>
    if first Residue in Chain has 'dssp' field, set self['initNCaC'] to hold those protein space coordinates to build the rest of the Chain from





    <h3>See also:</h3>
    <ul>
         <a href="../classes/Chain.html#Chain:assembleResidues">assembleResidues</a>
    </ul>


</dd>
    <dt>
    <a name = "Chain:countResidues"></a>
    <strong>Chain:countResidues ()</strong>
    </dt>
    <dd>
    report ordered (with coordinates) residues in this chain



    <h3>Returns:</h3>
    <ol>

        count of ordered residues
    </ol>




</dd>
</dl>


</div> <!-- id="content" -->
</div> <!-- id="main" -->
<div id="about">
<i>generated by <a href="http://github.com/stevedonovan/LDoc">LDoc 1.4.3</a></i>
<i style="float:right;">Last updated 2017-04-06 12:45:34 </i>
</div> <!-- id="about" -->
</div> <!-- id="container" -->
</body>
</html>
